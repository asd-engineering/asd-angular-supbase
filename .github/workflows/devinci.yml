name: DeVinci Cloud IDE

on:
  workflow_dispatch:
    inputs:
      username:
        description: 'Username for ttyd/code-server'
        required: true
        type: string
      password:
        description: 'Password for ttyd/code-server'
        required: true
        type: string
      region:
        description: 'Tunnel server region'
        required: false
        default: ''
        type: choice
        options:
          - ''
          - us-central
      asd-version:
        description: 'ASD CLI version'
        required: false
        default: 'latest'
        type: string

concurrency:
  group: devinci-${{ github.actor }}
  cancel-in-progress: false

jobs:
  devinci:
    runs-on: ubuntu-latest
    timeout-minutes: 360
    steps:
      - uses: actions/checkout@v4

      - uses: asd-engineering/asd-devinci@v1
        with:
          api-key: ${{ secrets.ASD_API_KEY }}
          username: ${{ inputs.username }}
          password: ${{ inputs.password }}
          region: ${{ inputs.region }}
          asd-version: ${{ inputs.asd-version }}
